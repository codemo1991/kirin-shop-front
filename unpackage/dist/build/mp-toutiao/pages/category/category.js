(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/category/category"],{"00d0":function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=n("2f62");function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function r(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach((function(e){a(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function a(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var s=function(){n.e("components/uni-collapse/uni-collapse").then(function(){return resolve(n("77ee"))}.bind(null,n)).catch(n.oe)},c=function(){n.e("components/uni-collapse-item/uni-collapse-item").then(function(){return resolve(n("49e3"))}.bind(null,n)).catch(n.oe)},l=function(){n.e("components/uni-number-box/uni-number-box").then(function(){return resolve(n("83e1"))}.bind(null,n)).catch(n.oe)},u=function(){n.e("components/uni-list/uni-list").then(function(){return resolve(n("2f89"))}.bind(null,n)).catch(n.oe)},d=function(){n.e("components/uni-list-item/uni-list-item").then(function(){return resolve(n("ccc0"))}.bind(null,n)).catch(n.oe)},f={components:{uniCollapse:s,uniCollapseItem:c,uniNumberBox:l,uniList:u,uniListItem:d},data:function(){var t;return{specClass:"none",sizeCalcState:!1,tabScrollTop:0,currentId:1,flist:[],slist:[],tlist:[],scrollHeight:"400px",leftArray:[],mainArray:[],leftIndex:0,addressData:(t={address:"",city:"",id:"",name:"",phone:"",province:"",zone:""},a(t,"id",""),a(t,"defaultFlag",0),t),total:0,goodTemp:{},orderTemp:{},scrollTop:0,old:{scrollTop:0}}},computed:r({leftIntoView:function(){return"left-".concat(this.leftIndex>5?this.leftIndex-5:0)}},(0,i.mapState)(["hasLogin","userInfo"])),mounted:function(){var t=this;this.$nextTick((function(){setTimeout((function(){t.initScrollView().then((function(){}))}),200)}))},onShow:function(){var t;this.hasLogin||(this.addressData=(t={address:"",city:"",id:"",name:"",phone:"",province:"",zone:""},a(t,"id",""),a(t,"defaultFlag",0),t));this.getListData()},onLoad:function(){var t;this.hasLogin?this.loadAddressInfo():this.addressData=(t={address:"",city:"",id:"",name:"",phone:"",province:"",zone:""},a(t,"id",""),a(t,"defaultFlag",0),t)},methods:{navTo:function(e){this.hasLogin?t.navigateTo({url:e}):t.showModal({title:"温馨提示",content:"此时此刻需要您登录喔~",confirmText:"去登录",cancelText:"再逛会",success:function(e){e.confirm&&t.navigateTo({url:"/pages/public/login"})}})},stopPrevent:function(){},toggleSpec:function(){var t=this;"show"===this.specClass?(this.specClass="hide",setTimeout((function(){t.specClass="none"}),250)):"none"===this.specClass&&(this.specClass="show")},calcTotal:function(){var t=this.orderTemp,e=0;for(var n in t)e+=t[n].totalPirceAmount;this.total=e},numberChange:function(t,e){t=parseInt(t);var n=this.goodTemp[e];if(0==t)delete this.orderTemp[n.goodDetailId];else{n["num"]=parseInt(t);var i=0;n.pinkAge>1&&t%n.pinkAge>0&&(i=parseFloat(n.deliveryFee),n["deliveryFeeAmount"]=" , 运费："+n.deliveryFee+"元"),n["totalPirce"]="￥"+(parseFloat(n.price)*t+i),n["totalPirceAmount"]=parseFloat(n.price)*t+i,n["totalDeliveryFee"]=i;var o=n.deliveryFeeAmount;n["desc"]="单价："+n.price+"元 , 数量："+t,void 0!=o&&(n["desc"]+=o),this.orderTemp[n.goodDetailId]=n}this.calcTotal()},tabtap:function(t){this.sizeCalcState||this.calcSize(),this.currentId=t.id;var e=this.slist.findIndex((function(e){return e.pid===t.id}));this.tabScrollTop=this.slist[e].top},asideScroll:function(t){this.sizeCalcState||this.calcSize();var e=t.detail.scrollTop,n=this.slist.filter((function(t){return t.top<=e})).reverse();n.length>0&&(this.currentId=n[0].pid)},calcSize:function(){var e=0;this.slist.forEach((function(n){var i=t.createSelectorQuery().select("#main-"+n.id);i.fields({size:!0},(function(t){n.top=e,e+=t.height,n.bottom=e})).exec()})),this.sizeCalcState=!0},initScrollView:function(){var e=this;return new Promise((function(n,i){var o=t.createSelectorQuery().select("#scroll-panel");o.boundingClientRect((function(t){e.scrollHeight="".concat(t.height,"px"),e.$nextTick((function(){n()}))})).exec()}))},getListData:function(){var t=this;new Promise((function(e,n){var i=t;t.$http.get(t.$httpApi.goods.category,{},{load:!1}).then((function(t){for(var n=[],o=[],r=0;r<t.length;r++){n.push(t[r].name);for(var a=t[r].goodDtos,s=[],c=0;c<a.length;c++){var l=a[c];s.push(l);for(var u=l.goodDetails,d=0;d<u.length;d++){var f=u[d];f["num"]=0,i.goodTemp[f.goodDetailId]=f}}o.push({title:t[r].name,list:s})}e({left:n,main:o})})).catch((function(t){}))})).then((function(e){t.leftArray=e.left,t.mainArray=e.main}))},leftTap:function(t){var e=t.currentTarget.dataset.index;this.leftIndex=Number(e)},swiperChange:function(t){var e=t.detail.current;this.leftIndex=Number(e)},loadAddressInfo:function(){var t=this;this.$http.get(this.$httpApi.address.defaultAddr,{}).then((function(e){t.addressData.address=e.address,t.addressData.city=e.city,t.addressData.id=e.id,t.addressData.name=e.name,t.addressData.phone=e.phone,t.addressData.province=e.province,t.addressData.zone=e.zone})).catch((function(t){}))},showOrder:function(){this.hasLogin?this.total&&0!=this.total?this.toggleSpec():this.$api.msg("请选择要购买的商品!!!"):t.showModal({title:"温馨提示",content:"此时此刻需要您登录喔~",confirmText:"去登录",cancelText:"再逛会",success:function(e){e.confirm&&t.navigateTo({url:"/pages/public/login"})}})},makeOrder:function(){if(this.total&&0!=this.total)if(null!=this.addressData.id&&""!=this.addressData.id){var e=this;t.showModal({title:"提示",content:"确认提交订单？",success:function(t){if(t.confirm){var n={},i=e.addressData.id,o=[],r=[],a=1;for(var s in e.orderTemp)o.push(s),r.push(e.orderTemp[s].num);n["orderType"]=a,n["goodDetailIds"]=o,n["nums"]=r,n["addressId"]=i,e.$http.post(e.$httpApi.order.makeOrder,n).then((function(t){e.orderTemp={},e.total=0,e.$api.msg("下单成功"),e.toggleSpec(),setTimeout((function(){e.getListData()}),500)})).catch((function(t){}))}}})}else this.$api.msg("请选择收货地址");else this.$api.msg("请选择要购买的商品!!!")}}};e.default=f}).call(this,n("f266")["default"])},"29e0":function(t,e,n){"use strict";(function(t){n("105b"),n("921b");i(n("66fd"));var e=i(n("a34a"));function i(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("f266")["createPage"])},3833:function(t,e,n){"use strict";var i=n("6c17"),o=n.n(i);o.a},"6c17":function(t,e,n){},"90be":function(t,e,n){"use strict";n.r(e);var i=n("00d0"),o=n.n(i);for(var r in i)"default"!==r&&function(t){n.d(e,t,(function(){return i[t]}))}(r);e["default"]=o.a},a090:function(t,e,n){"use strict";var i={uniCollapse:function(){return n.e("components/uni-collapse/uni-collapse").then(n.bind(null,"77ee"))},uniCollapseItem:function(){return n.e("components/uni-collapse-item/uni-collapse-item").then(n.bind(null,"49e3"))},uniNumberBox:function(){return n.e("components/uni-number-box/uni-number-box").then(n.bind(null,"83e1"))},uniList:function(){return n.e("components/uni-list/uni-list").then(n.bind(null,"2f89"))},uniListItem:function(){return n.e("components/uni-list-item/uni-list-item").then(n.bind(null,"ccc0"))}},o=function(){var t=this,e=t.$createElement;t._self._c},r=[];n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return r})),n.d(e,"a",(function(){return i}))},a34a:function(t,e,n){"use strict";n.r(e);var i=n("a090"),o=n("90be");for(var r in o)"default"!==r&&function(t){n.d(e,t,(function(){return o[t]}))}(r);n("3833");var a,s=n("f0c5"),c=Object(s["a"])(o["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],a);e["default"]=c.exports}},[["29e0","common/runtime","common/vendor"]]]);